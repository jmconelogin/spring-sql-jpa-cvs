accelerator:
  displayName: AEFW4Boot Kickstart Generator
  description: Frameworks provides three AEFW4Boot / Spring Boot flavors of kickstarts:
               - Spring Batch / Java JSR 352 oriented kickstart for deployment to batch servers
               - RESTful / Microservice Minimal Spring Boot for deployment to containers / Azure
               - Traditional Web kickstart almost identical to AEFW 3 kickstart
  iconUrl: https://github.com/jmconelogin/jmconelogin/blob/main/OIP.jpg?raw=true
  tags:
    - java
    - spring
    - microservice
    - azure

  # options for the UI
  options:
  - name: email1
    inputType: text
    label : Two Email Contacts
    description: Email 1
    required: true
  - name: email2
    inputType: text
    label: 
    description: Email 2
    required: true
  - name: storageClassName
    inputType: text
    label: The name of the storage class to use for the Postgres instance
    description: The name of the storage class to use for Postgres instance to create using the Tanzu Postgres Operator
    defaultValue: standard
    dependsOn:
      name: deploymentType
      value: workload
engine:
  merge:
    - include: [ "**" ]
      exclude: [ "pom.xml", "database/**", "config/**", "catalog/**", "README.md", "DEPLOYING.md" ]
    - include: [ "pom.xml" ]
      chain:
      - type: ReplaceText
        substitutions:
        - text: spring-sql-jpa
          with: "#artifactId"
    - include: [ "database/**" ]
      condition: "#deploymentType == 'workload'"
      chain:
      - type: ReplaceText
        substitutions:
        - text: postgres-sample
          with: "#postgresInstanceName"
      - type: ReplaceText
        substitutions:
          - text: standard
            with: "#storageClassName"
    - include: [ "catalog/**" ]
      condition: "#deploymentType == 'workload'"
      chain:
      - type: ReplaceText
        substitutions:
        - text: spring-sql-jpa
          with: "#artifactId"
    - include: [ "config/**" ]
      condition: "#deploymentType == 'workload'"
      chain:
      - type: ReplaceText
        substitutions:
        - text: ": spring-sql-jpa"
          with: "': ' + #artifactId"
    - name: README
      type: Combo
      onConflict: Append
      sources:
      - include: [ "README.md" ]
        chain:
        - type: ReplaceText
          substitutions:
          - text: spring-sql-jpa
            with: "#artifactId"
      - include: [ "DEPLOYING.md" ]
        condition: "#deploymentType == 'workload'"
        chain:
        - type: ReplaceText
          substitutions:
          - text: spring-sql-jpa
            with: "#artifactId"
        - type: RewritePath
          rewriteTo: "'README.md'"
